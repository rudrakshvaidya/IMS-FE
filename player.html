<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Players</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT"
      crossorigin="anonymous"
    />
<script>

function storePlayerId(playerId) {
  window.location.href = `playerstats.html?id=${playerId}`;
}

async function getPlayers() {   
  try {
    const response = await fetch("http://127.0.0.1:8000/players", {
      headers: {
        "Content-Type": "application/json",
        token: localStorage.getItem("token"),
      },
    });
    const data = await response.json();
    if (response.status === 200) {
      const player = document.getElementById("player");
      player.innerHTML = '<div class="row">';
      for(let i = 0; i < data.length; i++) {
        player.innerHTML += `
          <div class="col-md-4 mb-3">
            <div class="card">
              <img src="${data[i].image}" class="card-img-top" alt="${data[i].name}">
              <div class="card-body">
                <h5 class="card-title">${data[i].name}</h5>
                <p class="card-text">Playing for: ${data[i].playingFor}</p>
                <p class="card-text">Email: ${data[i].email}</p>
                <p class="card-text">${data[i].nationality}</p>
                <p class="card-text">${data[i].specialization}</p>
                <button onclick="storePlayerId('${data[i]._id}')" class="btn btn-primary">Stats</button>
              </div>
            </div>
          </div>`;
      }
      player.innerHTML += '</div>';
    } else {
      document.getElementById("response").textContent = 
        "Bad Request (400): " + JSON.stringify(data);
    }
  } catch (error) {
    document.getElementById("response").textContent = 
      "Error: " + error.message;
  }
}
      getPlayers()
      </script>
</head>

<body>

    <h1>Players</h1>
    <p id="response"></p>
    <div id="player">
    </div>    
    
</body>
</html>